---
title: 编辑器扩展
date: 2020-6-3 15-15
categories:
- Unity3D
tags:
- Unity3D
catalog: true
---

## 菜单项

### MenuItem

#### 常用的菜单那位置

  1. 整个Unity编辑器顶头的菜单栏；

  2. Inspector挂Component的；

  3. Hierarchy游戏物体节点树的；

  4. Project游戏资源文件的。

#### 验证菜单栏

为某个菜单项写一个bool方法。   
第二个参数表示，是否为验证函数

```csharp 

[MenuItem("MyMenu/LogTransFormname")] 

static void LogTransformName()

{ 

Debug.Log("TransformName is "+Selection.activeTransform.name); 

} 

[MenuItem("MyMenu/LogTransFormname",true)] 

static bool ValidatedLogTransformName()

{ 

return Selection.activeTransform!=null; 

} 

``` 

#### 自定义快捷键

菜单名称+空格+快捷键   
_g 按下字母g   
修饰符: % Ctrl; # Shift; & Alt   
LEFT、RIGHT、UP、DOWN、F1..F12、HOME、END、PGUP、PGDN

```csharp 

[MenuItem("MyMenu/AddKey %j")] 

static void AddKey()

{ 

Debug.Log("this is addKey"); 

} 

``` 

#### 优先级

默认为1000   
差距为11以上分组

#### 给组件或脚本添加右键方法（Inspector）

传入参数 MenuCommand   
command.context : 被右键点击的脚本对象

```csharp 

[MenuItem("CONTEXT/Transform/DoubleTran")] 

static void DoubleTran(MenuCommand command)

{ 

Transform body =(Transform)command.context; 

body.position*=2; 

Debug.Log("doubleTrans is"+body.position); 

} 

``` 

#### 其他位置

```csharp 

//Hierarchy窗口下

[MenuItem("GameObject/Test2", false, 11)] 

public static void PasteTRValue()

{ 

Debug.Log("Test2"); 

} 

//Project窗口下

[MenuItem("Assets/Test3", false)] 

public static void Test3()

{ 

Debug.Log("Test3"); 

} 

``` 

### ContextMenu & ContextMenuItem

  * 写在本身Component脚本中，隶属于UnityEngine命名空间，会被打包。

  * 功能和参数与MenuItem完全一致

  * 非静态

ContextMenuItem: 给你在右键变量名称时添加菜单   
参数:1.菜单的名称；2.菜单执行的方法，要求脚本中必须有；3.按钮的先后顺序。

```csharp 

using UnityEngine; 

public class Clock : MonoBehaviour

{ 

[ContextMenuItem("Add Hour", "AddHour", order = 1)] 

public int Hour = 10; 

public void AddHour()

{ 

Hour += 1; 

} 

[ContextMenu("Sub Hour", false, 10)] 

public void SubHour()

{ 

Hour -= 1; 

} 

} 

``` 

### 注册撤销操作

Undo.RegisterCreatedObjectUndo方法注册撤销操作

