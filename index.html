<!DOCTYPE html>


<html lang="en">
  

    <head>
      <meta charset="utf-8" />
        
      <meta
        name="viewport"
        content="width=device-width, initial-scale=1, maximum-scale=1"
      />
      <title> 半个出家人</title>
  <meta name="generator" content="hexo-theme-ayer">
      
      <link rel="shortcut icon" href="/img/circle_image.png" />
       
<link rel="stylesheet" href="/dist/main.css">

      
<link rel="stylesheet" href="/css/fonts/remixicon.css">

      
<link rel="stylesheet" href="/css/custom.css">
 
      <script src="https://cdn.staticfile.org/pace/1.2.4/pace.min.js"></script>
       
 

      <link
        rel="stylesheet"
        href="https://cdn.jsdelivr.net/npm/@sweetalert2/theme-bulma@5.0.1/bulma.min.css"
      />
      <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.19/dist/sweetalert2.min.js"></script>

      <!-- mermaid -->
      
      <style>
        .swal2-styled.swal2-confirm {
          font-size: 1.6rem;
        }
      </style>
    <link rel="alternate" href="/atom.xml" title="半个出家人" type="application/atom+xml">
</head>
  </html>
</html>


<body>
  <div id="app">
    
      
    <main class="content on">
      
<section class="cover">
    
      
      <a class="forkMe" href="https://github.com/Shen-Yu/hexo-theme-ayer"
        target="_blank"><img width="149" height="149" src="/images/forkme.png"
          class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    
  <div class="cover-frame">
    <div class="bg-box">
      <img src="img/header_img/home-bg-1.jpg" alt="image frame" />
    </div>
    <div class="cover-inner text-center text-white">
      <h1><a href="/">半个出家人</a></h1>
      <div id="subtitle-box">
        
        <span id="subtitle"></span>
        
      </div>
      <div>
        
      </div>
    </div>
  </div>
  <div class="cover-learn-more">
    <a href="javascript:void(0)" class="anchor"><i class="ri-arrow-down-line"></i></a>
  </div>
</section>



<script src="https://cdn.staticfile.org/typed.js/2.0.12/typed.min.js"></script>


<!-- Subtitle -->

  <script>
    try {
      var typed = new Typed("#subtitle", {
        strings: ['The world isn&#39;t split into good people and Death Eaters. We&#39;ve all got both light and dark inside us. What matters is the part we choose to act on. That&#39;s who we really are.', '愿你一生努力，一生被爱', '想要的都拥有，得不到的都释怀'],
        startDelay: 0,
        typeSpeed: 100,
        loop: true,
        backSpeed: 80,
        showCursor: true
      });
    } catch (err) {
      console.log(err)
    }
  </script>
  
<div id="main">
  <section class="outer">
  
  <ul class="ads">
    
        <li>
            <a href="https://curl.qcloud.com/kvO7hb43" target="_blank" rel="noopener">
                <img src="https://pic.imgdb.cn/item/62174b452ab3f51d912a5ccc.jpg" width="300" alt="云服务器限时秒杀">
            </a>
        </li>
    
        <li>
            <a href="https://www.vultr.com/?ref=8630075" target="_blank" rel="noopener">
                <img src="https://pic.imgdb.cn/item/62174b452ab3f51d912a5cd7.png" width="300" alt="vultr优惠vps">
            </a>
        </li>
    
</ul>
  
  
  

<div class="notice" style="margin-top:50px">
    <i class="ri-heart-fill"></i>
    <div class="notice-content" id="broad"></div>
</div>
<script type="text/javascript">
    fetch('https://v1.hitokoto.cn')
        .then(response => response.json())
        .then(data => {
            document.getElementById("broad").innerHTML = data.hitokoto;
        })
        .catch(console.error)
</script>

<style>
    .notice {
        padding: 20px;
        border: 1px dashed #e6e6e6;
        color: #969696;
        position: relative;
        display: inline-block;
        width: 100%;
        background: #fbfbfb50;
        border-radius: 10px;
    }

    .notice i {
        float: left;
        color: #999;
        font-size: 16px;
        padding-right: 10px;
        vertical-align: middle;
        margin-top: -2px;
    }

    .notice-content {
        display: initial;
        vertical-align: middle;
    }
</style>
  
  <article class="articles">
    
    
    
    
    <article
  id="post-Unreal-遇到的问题及解决"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3/"
    >遇到的问题及解决</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E5%8F%8A%E8%A7%A3%E5%86%B3/" class="article-date">
  <time datetime="2023-07-25T12:56:23.426Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>修改代码不生效：需要在VS中Rebuild，或者在UE中对Module进行Recompile</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-【CI】Mac自动导入证书"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-%E3%80%90CI%E3%80%91Mac%E8%87%AA%E5%8A%A8%E5%AF%BC%E5%85%A5%E8%AF%81%E4%B9%A6/"
    >【CI】Mac自动导入证书</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-%E3%80%90CI%E3%80%91Mac%E8%87%AA%E5%8A%A8%E5%AF%BC%E5%85%A5%E8%AF%81%E4%B9%A6/" class="article-date">
  <time datetime="2023-07-25T12:56:23.425Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><code>csharp pipeline { stages { stage(&#39;Code Sign&#39;) { steps { sh &quot;&quot;&quot; # Create Temp Keychain and Import security create-keychain -p $TEMP_KEYCHAIN_PASSWORD $TEMP_KEYCHAIN_NAME security import $CERT_FILE_PATH -k $TEMP_KEYCHAIN_NAME -P $CERT_PASSPHRASE -T /usr/bin/codesign # Set Partition List security set-key-partition-list -S apple-tool:,apple: -s -k $TEMP_KEYCHAIN_PASSWORD $TEMP_KEYCHAIN_NAME # Set Search List security list-keychains -s `security list-keychains | xargs` $TEMP_KEYCHAIN_NAME # Other Settings security set-keychain-settings -t 3600 $TEMP_KEYCHAIN_NAME security unlock-keychain -p $TEMP_KEYCHAIN_PASSWORD $TEMP_KEYCHAIN_NAME # Show Identities security find-identity -vp codesigning # Do your own work here &quot;&quot;&quot; } } } post { cleanup { sh &quot;&quot;&quot; # Remove Temp Keychain security delete-keychain $TEMP_KEYCHAIN_NAME || true &quot;&quot;&quot; } }}</code> </p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-常见问题"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/"
    >常见问题</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" class="article-date">
  <time datetime="2023-07-25T12:56:23.425Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>adaptive icon 问题： <a href="https://www.unrealengine.com/en-US/tech-blog/adding-adaptive-icons-to-a-ue4-project-for-android" target="_blank" rel="noopener">https://www.unrealengine.com/en-US/tech-blog/adding-adaptive-icons-to-a-ue4-project-for-android</a></p>
<p>接入插件后，无法用Unreal Editor启动工程</p>
<p>要把插件编译成与Unreal Editor版本一致的版本。并且要把Development Editor Win64版本的编译出来，因为Unreal Editor是在Windows上启动的，即使工程是Android工程，也不能只编译Android的。ban’ben</p>
<p>Output乱码：<a href="https://blog.csdn.net/netyeaxi/article/details/81206896" target="_blank" rel="noopener">https://blog.csdn.net/netyeaxi/article/details/81206896</a></p>
<h1 id="“error-LNK2019-无法解析的外部符号”"><a href="#“error-LNK2019-无法解析的外部符号”" class="headerlink" title="“error LNK2019: 无法解析的外部符号”"></a><a href="https://www.cnblogs.com/hiloves/p/4678848.html" target="_blank" rel="noopener">“error LNK2019: 无法解析的外部符号”</a></h1><p>函数声明了，但是没有写实现</p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-技术笔记"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/"
    >技术笔记</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-%E6%8A%80%E6%9C%AF%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2023-07-25T12:56:23.425Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>UE_LOG:</p>
<p><a href="https://blog.csdn.net/zhang1461376499/article/details/113351948" target="_blank" rel="noopener">https://blog.csdn.net/zhang1461376499/article/details/113351948</a></p>
<p><a href="https://blog.csdn.net/liulong1567/article/details/52449000" target="_blank" rel="noopener">https://blog.csdn.net/liulong1567/article/details/52449000</a></p>
<p><a href="https://unrealcommunity.wiki/logging-lgpidy6i" target="_blank" rel="noopener">https://unrealcommunity.wiki/logging-lgpidy6i</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-无标题笔记"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/"
    >无标题笔记</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-%E6%97%A0%E6%A0%87%E9%A2%98%E7%AC%94%E8%AE%B0/" class="article-date">
  <time datetime="2023-07-25T12:56:23.425Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
   
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-类与API"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-%E7%B1%BB%E4%B8%8EAPI/"
    >类与API</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-%E7%B1%BB%E4%B8%8EAPI/" class="article-date">
  <time datetime="2023-07-25T12:56:23.425Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <ul>
<li>UObject </li>
</ul>
<h2 id="UObject"><a href="#UObject" class="headerlink" title="UObject"></a>UObject</h2> 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-【C-】常用预处理指令"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-%E3%80%90C-%E3%80%91%E5%B8%B8%E7%94%A8%E9%A2%84%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4/"
    >【C++】常用预处理指令</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-%E3%80%90C-%E3%80%91%E5%B8%B8%E7%94%A8%E9%A2%84%E5%A4%84%E7%90%86%E6%8C%87%E4%BB%A4/" class="article-date">
  <time datetime="2023-07-25T12:56:23.424Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><a href="https://blog.csdn.net/cartzhang/article/details/22726167" target="_blank" rel="noopener">https://blog.csdn.net/cartzhang/article/details/22726167</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-Unreal资源管理"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-Unreal%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/"
    >Unreal资源管理</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-Unreal%E8%B5%84%E6%BA%90%E7%AE%A1%E7%90%86/" class="article-date">
  <time datetime="2023-07-25T12:56:23.413Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p>说明：较大的篇幅整理自知乎答主quabqi的文章。链接：<a href="https://zhuanlan.zhihu.com/p/357904199" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/357904199</a></p>
<h2 id="UE4的资源文件和内存里对象的关系是什么？"><a href="#UE4的资源文件和内存里对象的关系是什么？" class="headerlink" title="UE4的资源文件和内存里对象的关系是什么？"></a>UE4的资源文件和内存里对象的关系是什么？</h2><p>Content目录下的资源：uasset（大部分）, umap 作为后缀<br>在打包时，这些文件可能会根据平台需要，被cook成更小的平台专用文件，然后被放在后缀是pak的压缩包里。<br>游戏运行时，程序就会挂载解压这些pak包，然后加载包中的资源文件来使用。<br>程序在用资源的时候，把这些文件转化为UObject或其他程序可以用的内存对象。</p>
<p>Asset is a UObject that can be dumped down to file (uasset package) and can be loaded back to the memory from that file and in is mainly used to store game resources, when you load them they are avable in memory as UObject objects like UBlueprint, UTexture2D, USkeletalMesh. USoundWave and so on. Every type of asset you see in content browser has corresponding class and each asset you see in “content Browser” is a UObject that is in memory or can be loaded in memory.</p>
<blockquote>
<p>网格资源文件，程序用的实际是UStaticMesh对象</p>
</blockquote>
<h2 id="资源-gt-UObject对象"><a href="#资源-gt-UObject对象" class="headerlink" title="资源-&gt;UObject对象"></a>资源-&gt;UObject对象</h2><p>把资源文件，转变为内存里的UObject对象</p>
<ul>
<li>读取资源文件的数据到内存</li>
<li>根据内存的二进制数据，把空壳对象反序列化成实际的对象</li>
<li>如果这个对象有依赖其他对象，就递归的去做1和2的操作，直到这个对象完整可用</li>
<li>调用对象的初始化函数，并将对象加入到引擎的对象管理中</li>
</ul>
<h2 id="加载与查找"><a href="#加载与查找" class="headerlink" title="加载与查找"></a>加载与查找</h2><h3 id="查找"><a href="#查找" class="headerlink" title="查找"></a>查找</h3><p>FindObject<br>FindObjectFast<br>FindObjectChecked<br>FindObjectSafe<br>FSoftObjectPath::ResolveObject</p>
<p>在内存中查找对象，找到就会返回，找不到会返回nullptr，不会触发加载。<br>如果传入了Outer，就会在Outer所在的Package下面找对应的资源对象，如果没有Outer就会在全局找这个资源对象。</p>
<h3 id="同步加载资源"><a href="#同步加载资源" class="headerlink" title="同步加载资源"></a>同步加载资源</h3><p>LoadObject<br>LoadClass<br>LoadPackage</p>
<p>先调用FindObject在内存中找，找到了直接返回，没找到就会进入同步加载。再深入底层可以看到，最终调用的是LoadPackageAsync函数，这就是异步加载的入口，并且最后FlushAsyncLoading，内部阻塞等待，将异步加载转为同步</p>
<p>FSoftObjectPath::TryLoad<br>FStreamableManager::RequestSyncLoad<br>FStreamableManager::LoadSynchronous<br>FStreamableManager::RequestAsyncLoad<br>FlushAsyncLoading（异步转同步）</p>
<p>更上层的封装，最终走到LoadPackageAsync</p>
<h3 id="异步加载资源"><a href="#异步加载资源" class="headerlink" title="异步加载资源"></a>异步加载资源</h3><p>LoadPackageAsync<br>FStreamableManager::RequestAsyncLoad</p>
<h3 id="判断加载状态"><a href="#判断加载状态" class="headerlink" title="判断加载状态"></a>判断加载状态</h3><p>GIsSavingPackage<br>IsGarbageCollectingOnGameThread<br>IsLoading<br>GetNumAsyncPackages<br>GetAsyncLoadPercentage<br>FStreamableManager::IsAsyncLoadComplete</p>
<h3 id="加载底层深入"><a href="#加载底层深入" class="headerlink" title="加载底层深入"></a>加载底层深入</h3><p><img src="Unreal资源管理/Image.png" alt=""></p>
<p>一个UPackage文件就是这样的，有很多UObject序列化的二进制数据</p>
<p><a href="https://zhuanlan.zhihu.com/p/357904199" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/357904199</a></p>
<p>加载的模式：</p>
<p>加载的模式引擎加载资源内部有两种模式，一个是Async，一个是EDL（EventDrivenLoader）<br>Async：会启动一个专门的加载线程负责Tick资源加载<br>EDL：在主线程Tick加载，加载的每一个步骤通过事件串联起来  </p>
<p><img src="Unreal资源管理/Image_1.png" alt=""></p>
<h3 id="硬引用-amp-软引用"><a href="#硬引用-amp-软引用" class="headerlink" title="硬引用 &amp; 软引用"></a>硬引用 &amp; 软引用</h3><p>硬引用就是自己的对象上，用UProperty标记的那些UObject指针变量，当在反序列化对象时，因为这些变量引用的资源必须跟着一起序列化好才能保证当前的对象是好的，所以这些变量在存储时会反应到Import表里面。自己写的UProperty资源越多，这个资源加载的就越慢</p>
<p>软引用就是FSoftObjectPath或TSoftObjectPtr引用的资源变量，这些不会随着当前对象一起加载，但是需要业务逻辑在需要用的时候手动调用加载代码来加载。</p>
<h2 id="Asset-Registry-amp-Object-Libraries"><a href="#Asset-Registry-amp-Object-Libraries" class="headerlink" title="Asset Registry &amp; Object Libraries"></a>Asset Registry &amp; Object Libraries</h2><h3 id="Asset-Registry"><a href="#Asset-Registry" class="headerlink" title="Asset Registry"></a>Asset Registry</h3><p>Background:</p>
<ul>
<li>As assets are UObjects normally you would seek them out from reflection system.</li>
<li>Searching them in reflection system is pointless if they are not loaded first.</li>
</ul>
<p>The asset registry is a system that stores metadata about assets and allows searches and queries about those assets.</p>
<p>It <strong>keep track of Assets regardless if they are loaded or not</strong>.<br>It allows you to list out assets, get there regestry entry (FAssetData) and load them up, it also a to more optimized way to seek assets that are loaded already, as well as edit there registry information.</p>
<p>“Content Browser” in reality is Asset Registry explorer and it mainly use AssetRegistry to list and edit assets in there.</p>
<h3 id="ObjectLibrary"><a href="#ObjectLibrary" class="headerlink" title="ObjectLibrary"></a>ObjectLibrary</h3><p>An ObjectLibrary is an object that contains a list of either loaded objects or FAssetData for unloaded objects.</p>
<p><code>csharp if (!ObjectLibrary) { ObjectLibrary = UObjectLibrary::CreateLibrary(BaseClass, false, GIsEditor); ObjectLibrary-&gt;AddToRoot(); } ObjectLibrary-&gt;LoadAssetDataFromPath(TEXT(&quot;/Game/PathWithAllObjectsOfSameType&quot;); if (bFullyLoad) { ObjectLibrary-&gt;LoadAssetsFromAssetData(); }</code> </p>
<h3 id="StreamableManager-amp-Asynchronous-Loading"><a href="#StreamableManager-amp-Asynchronous-Loading" class="headerlink" title="StreamableManager &amp; Asynchronous Loading"></a>StreamableManager &amp; Asynchronous Loading</h3><p>FStreamableManager::RequestSyncLoad<br>FStreamableManager::LoadSynchronous<br>FStreamableManager::RequestAsyncLoad</p>
<p>pass your <strong>FSoftObjectPath</strong> into it and start a load</p>
<blockquote>
<p>You can use the same method to asynchronously load a <strong>FAssetData</strong> , just call ToStringReference on them, add them to an array, and call RequestAsyncLoad with a delegate.</p>
</blockquote>
<h2 id="卸载"><a href="#卸载" class="headerlink" title="卸载"></a>卸载</h2><p><img src="Unreal资源管理/Image_2.png" alt=""></p>
<p><img src="Unreal资源管理/Image_3.png" alt=""></p>
<h2 id="文档连接"><a href="#文档连接" class="headerlink" title="文档连接"></a>文档连接</h2><p>Asset Registry：<a href="https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/ProgrammingWithCPP/Assets/Registry/" target="_blank" rel="noopener">https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/ProgrammingWithCPP/Assets/Registry/</a></p>
<p>Asynchronous Asset Loading:<a href="https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/ProgrammingWithCPP/Assets/AsyncLoading/" target="_blank" rel="noopener">https://docs.unrealengine.com/4.27/en-US/ProgrammingAndScripting/ProgrammingWithCPP/Assets/AsyncLoading/</a></p>
<p>UObjectLibrary:<a href="https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Engine/UObjectLibrary/CreateLibrary/" target="_blank" rel="noopener">https://docs.unrealengine.com/4.27/en-US/API/Runtime/Engine/Engine/UObjectLibrary/CreateLibrary/</a></p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a href="https://zhuanlan.zhihu.com/p/357904199" target="_blank" rel="noopener">https://zhuanlan.zhihu.com/p/357904199</a><br><a href="https://blog.csdn.net/qq_40947718/article/details/108521495" target="_blank" rel="noopener">https://blog.csdn.net/qq_40947718/article/details/108521495</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-Unreal工程目录结构"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-Unreal%E5%B7%A5%E7%A8%8B%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/"
    >Unreal工程目录结构</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-Unreal%E5%B7%A5%E7%A8%8B%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84/" class="article-date">
  <time datetime="2023-07-25T12:56:23.412Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <p><a href="https://muyunsoft.com/blog/Unreal4/Basic/DirectoryStructure.html#%E6%A0%B9%E7%9B%AE%E5%BD%95" target="_blank" rel="noopener">https://muyunsoft.com/blog/Unreal4/Basic/DirectoryStructure.html#%E6%A0%B9%E7%9B%AE%E5%BD%95</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
    <article
  id="post-Unreal-Unreal插件开发"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h2 itemprop="name">
  <a class="article-title" href="/2023/07/25/Unreal-Unreal%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/"
    >Unreal插件开发</a> 
</h2>
 

      
    </header>
     
    <div class="article-meta">
      <a href="/2023/07/25/Unreal-Unreal%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91/" class="article-date">
  <time datetime="2023-07-25T12:56:23.412Z" itemprop="datePublished">2023-07-25</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Unreal/">Unreal</a>
  </div>
   
    </div>
      
    <div class="article-entry" itemprop="articleBody">
       
  <h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p>Engine /[UE4 Root]/Engine/Plugins/[Plugin Name]/</p>
<p>Game /[Project Root]/Plugins/[Plugin Name]/<br>(will be detected and loaded at Engine or Editor start-up time)</p>
<p>Public/Classes的父目录名就是module名</p>
<h3 id="Plugin-Descriptor-Files"><a href="#Plugin-Descriptor-Files" class="headerlink" title="Plugin Descriptor Files"></a>Plugin Descriptor Files</h3><p>Plugin descriptor Files: <code>.uplugin</code><br>API: <a href="https://docs.unrealengine.com/4.27/en-US/API/Runtime/Projects/FPluginDescriptor/" target="_blank" rel="noopener">https://docs.unrealengine.com/4.27/en-US/API/Runtime/Projects/FPluginDescriptor/</a></p>
<p>Category：类目名即在插件浏览器中所属的类目。<br>Installed：默认启用或禁用状态，在插件浏览器中可以控制加载卸载插件模块。<br>Modules：描述模块名、运行类型、加载时机、支持平台等信息。<br>Type：Runtime，RuntimeNoCommandlet，Developer，Editor，EditorNoCommandlet，Program。<br>LoadingPhase：Default，PreDefault，PostConfigInit，PostConfigInit。<br>WhitelistPlatforms：支持的平台<br>BlacklistPlatforms：不支持的平台</p>
<h2 id="操作方法"><a href="#操作方法" class="headerlink" title="操作方法"></a>操作方法</h2><p>unreal的理念是开发工作都是在工程目录进行，包括插件开发</p>
<h3 id="打包发布"><a href="#打包发布" class="headerlink" title="打包发布"></a>打包发布</h3><p><a href="https://blog.csdn.net/jxyb2012/article/details/88839224" target="_blank" rel="noopener">https://blog.csdn.net/jxyb2012/article/details/88839224</a></p>
<p><code>csharp &quot;E:\Program Files\Epic Games\UE_4.25\Engine\Build\BatchFiles\RunUAT.bat&quot; BuildPlugin Plugin=&quot;D:\work\UE4_25\PluginFactory\Plugins\MyNewPlugin\MyNewPlugin.uplugin&quot; Package=&quot;D:\work\UE4_25\PluginPackaged&quot;</code> </p>
<h2 id="插件编译执行过程"><a href="#插件编译执行过程" class="headerlink" title="插件编译执行过程"></a>插件编译执行过程</h2><p>Plugins will automatically be compiled by UBT when compiling your game project.</p>
<p><code>csharp #pragma once #include &quot;CoreMinimal.h&quot; #include &quot;ModuleManager.h&quot; class FPanoCamModule : public IModuleInterface { public: /** IModuleInterface implementation */ virtual void StartupModule() override; virtual void ShutdownModule() override; };</code> </p>
<p>每个独立模块都有一个类继承自 IModuleInterface，重写了插件加载卸载的方法。</p>
<p>.uplugin文件中Modules下的LoadingPhase字段说明了模块加载的时机，当满足这个时机时此模块StartupModule函数将被调用。此插件的功能入口就是从这里开始。当程序关闭或主动调用ShutdownModule函数时，模块将被卸载。</p>
<h2 id="编辑器拓展开发接口"><a href="#编辑器拓展开发接口" class="headerlink" title="编辑器拓展开发接口"></a>编辑器拓展开发接口</h2><p>LevelEditorModule.GetToolBarExtensibilityManager()可以拓展关卡编辑器的工具栏，GetMenuExtensibilityManager()可以拓展菜单栏。<br>GEditor-&gt;GetEditorSubsystem<UAssetEditorSubsystem>()-&gt;OnAssetOpenedInEditor()，可以监听UE中，任意编辑器打开的事件。<br>FCoreUObjectDelegates::OnObjectPropertyChanged可以监听任意Object，任意属性的变化事件。</p>
<h2 id="其他技巧"><a href="#其他技巧" class="headerlink" title="其他技巧"></a>其他技巧</h2><h3 id="Include"><a href="#Include" class="headerlink" title="Include"></a>Include</h3><blockquote>
<p>unreal中所有头文件都可以include。只是ue建议只include public目录或Classes的头文件，不建议include private目录的。</p>
</blockquote>
<h4 id="Include-public"><a href="#Include-public" class="headerlink" title="Include public"></a>Include public</h4><p>在XXX.Build.cs文件中添加依赖Module：PublicDependencyModuleNames.AddRange<br>然后在某个源码文件，直接include。（从Public/Classes开始算路径）</p>
<h4 id="Include-private"><a href="#Include-private" class="headerlink" title="Include private"></a>Include private</h4><p>在当前插件模块的build.cs文件中添加Private目录:</p>
<p><code>csharp var EngineDir = Path.GetFullPath(Target.RelativeEnginePath); PrivateIncludePaths.AddRange( new string[] { Path.Combine(EngineDir, &quot;Source/Editor/AnimationBlueprintEditor/Private/&quot;), });</code> <code>csharp // 用尖括号也可以 #include &quot;AnimationBlueprintEditor.h&quot;</code> </p>
<h3 id="添加第三方依赖库"><a href="#添加第三方依赖库" class="headerlink" title="添加第三方依赖库"></a>添加第三方依赖库</h3><p>PublicIncludePaths.Add(zlibPath + “include” + platform); //把（.h）头文件路径引入。<br>PublicLibraryPaths.Add(zlibPath + “lib” + platform); //把（.lib）库文件路径引入。<br>PublicAdditionalLibraries.Add(“zlibstatic.lib”); //把（.lib）库文件引入。</p>
<p><a href="https://blog.csdn.net/jxyb2012/article/details/88839224" target="_blank" rel="noopener">https://blog.csdn.net/jxyb2012/article/details/88839224</a></p>
<h4 id="链接错误的解决方法"><a href="#链接错误的解决方法" class="headerlink" title="链接错误的解决方法"></a>链接错误的解决方法</h4><ol>
<li>确保：把所属module添加到PublicDependencyModuleNames中</li>
<li>确保：如果缺失的函数or类是某个插件中的，需要标识为API，在函数前加入对应API宏。</li>
</ol>
<blockquote>
<p>例如module名为SamplePlg，则API宏为：SAMPLEPLG_API</p>
</blockquote>
<h3 id="访问private或protected的UPROPERTY"><a href="#访问private或protected的UPROPERTY" class="headerlink" title="访问private或protected的UPROPERTY"></a>访问private或protected的UPROPERTY</h3><p><code>csharp USTRUCT() struct FAnimLinkableElement { GENERATED_USTRUCT_BODY() protected: /** The slot index we are currently using within LinkedMontage */ UPROPERTY(EditAnywhere, Category=AnimLink) int32 SlotIndex; };</code> <code>csharp int32* GetSlotIndex(void *pAnimLinkableElement) { static UScriptStruct* Struct = FindObjectSafe&lt;UScriptStruct&gt;(ANY_PACKAGE, TEXT(&quot;AnimLinkableElement&quot;)); auto Prop = Struct-&gt;FindPropertyByName(TEXT(&quot;SlotIndex&quot;)); check(Prop); return Prop-&gt;ContainerPtrToValuePtr&lt;int32&gt;(pAnimLinkableElement); }</code> </p>
<h2 id="Build-cs"><a href="#Build-cs" class="headerlink" title="Build.cs"></a>Build.cs</h2><p>配置文件属性详细说明：<a href="https://blog.csdn.net/jxyb2012/article/details/88839224" target="_blank" rel="noopener">https://blog.csdn.net/jxyb2012/article/details/88839224</a></p>
<p><code>csharp using UnrealBuildTool; using System.IO; //路径获取需要用到IO public class TestPlugin : ModuleRules ｛ private string ModulePath //当前TestPlugin.Build.cs文件所在的路径 ｛ get ｛ return Path.GetDirectoryName(RulesCompiler.GetModuleFilename(this.GetType().Name)); ｝ ｝ private string ThirdPartyPath //这个插件引用的第三方库的目录 ｛ get ｛ return Path.GetFullPath(Path.Combine(ModulePath, &quot;../../ThirdParty/&quot;)); ｝ ｝ private string MyTestLibPath //第三方库MyTestLib的目录 ｛ get ｛ return Path.GetFullPath(Path.Combine(ThirdPartyPath, &quot;MyTestLib&quot;)); ｝ ｝ public TestPlugin(TargetInfo Target) ｛ PCHUsage = ModuleRules.PCHUsageMode.UseExplicitOrSharedPCHs; PublicIncludePaths.AddRange( //公有文件搜索路径 new string[] ｛ &quot;TestPlugin/Public&quot; // ... add public include paths required here ... ｝ ); PrivateIncludePaths.AddRange( new string[] ｛ &quot;TestPlugin/Private&quot; //私有文件搜索路径 // ... add other private include paths required here ... ｝ ); PublicDependencyModuleNames.AddRange( new string[] ｛ &quot;Core&quot; // ... add other public dependencies that you statically link with here ... ｝ ); PrivateDependencyModuleNames.AddRange( new string[] ｛ &quot;CoreUObject&quot;, &quot;Engine&quot;, &quot;Slate&quot;, &quot;SlateCore&quot;, // ... add private dependencies that you statically link with here ... ｝ ); DynamicallyLoadedModuleNames.AddRange( new string[] ｛ // ... add any modules that your module loads dynamically here ... ｝ ); LoadThirdPartyLib(Target); //加载第三方库 ｝ public bool LoadThirdPartyLib(TargetInfo Target) ｛ bool isLibrarySupported = false; if ((Target.Platform == UnrealTargetPlatform.Win64) || (Target.Platform == UnrealTargetPlatform.Win32))//平台判断 ｛ isLibrarySupported = true; System.Console.WriteLine(&quot;\----- isLibrarySupported true&quot;); string PlatformSubPath = (Target.Platform == UnrealTargetPlatform.Win64) ? &quot;Win64&quot; : &quot;Win32&quot;; string LibrariesPath = Path.Combine(MyTestLibPath, &quot;Lib&quot;); PublicAdditionalLibraries.Add(Path.Combine(LibrariesPath, PlatformSubPath, &quot;TestLib.lib&quot;));//加载第三方静态库.lib ｝ if (isLibrarySupported) //成功加载库的情况下，包含第三方库的头文件 ｛ // Include path System.Console.WriteLine(&quot;\----- PublicIncludePaths.Add true&quot;); PublicIncludePaths.Add(Path.Combine(MyTestLibPath, &quot;Include&quot;)); ｝ return isLibrarySupported; ｝ ｝</code> </p>
<h2 id="Ref"><a href="#Ref" class="headerlink" title="Ref"></a>Ref</h2><p><a href="https://www.jianshu.com/p/ec0ae889f417" target="_blank" rel="noopener">https://www.jianshu.com/p/ec0ae889f417</a><br><a href="https://www.jianshu.com/p/49684c1b6011" target="_blank" rel="noopener">https://www.jianshu.com/p/49684c1b6011</a><br><a href="https://gameinstitute.qq.com/community/detail/121298" target="_blank" rel="noopener">https://gameinstitute.qq.com/community/detail/121298</a></p>
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <footer class="article-footer">
       
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Unreal/" rel="tag">Unreal</a></li></ul>

    </footer>
  </div>

   
    
</article>

    
  </article>
  

  
  <nav class="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/archives/2/">2</a><a class="page-number" href="/archives/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/archives/13/">13</a><a class="extend next" rel="next" href="/archives/2/">下一页</a>
  </nav>
  
</section>
</div>

      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2015-2023
        <i class="ri-heart-fill heart_icon"></i> Prin
      </li>
    </ul>
    <ul>
      <li>
        
      </li>
    </ul>
    <ul>
      <li>
        
        
        <span>
  <span><i class="ri-user-3-fill"></i>Visitors:<span id="busuanzi_value_site_uv"></span></span>
  <span class="division">|</span>
  <span><i class="ri-eye-fill"></i>Views:<span id="busuanzi_value_page_pv"></span></span>
</span>
        
      </li>
    </ul>
    <ul>
      
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzz统计 -->
        
        <script type="text/javascript" src='https://s9.cnzz.com/z_stat.php?id=1278069914&amp;web_id=1278069914'></script>
        
      </li>
    </ul>
  </div>
</footer>    
    </main>
    <div class="float_btns">
      <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

    </div>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/img/circle_image.png" alt="半个出家人"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/">主页</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">归档</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">分类</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">标签</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">友链</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/about">关于我</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories/Unreal">虚幻引擎</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>请我喝杯咖啡吧~</p>
  <div class="reward-box">
    
    <div class="reward-item">
      <img class="reward-img" src="/images/alipay.jpg">
      <span class="reward-type">支付宝</span>
    </div>
    
    
    <div class="reward-item">
      <img class="reward-img" src="/images/wechat.jpg">
      <span class="reward-type">微信</span>
    </div>
    
  </div>
</div>
    
<script src="/js/jquery-3.6.0.min.js"></script>
 
<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->

<script src="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.js"></script>
<link
  rel="stylesheet"
  href="https://cdn.staticfile.org/jquery-modal/0.9.2/jquery.modal.min.css"
/>
<script src="https://cdn.staticfile.org/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->
 <!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.staticfile.org/photoswipe/4.1.3/default-skin/default-skin.min.css">
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="https://cdn.staticfile.org/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // slider展开状态
                // todo: 这样不好，后面改成状态
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // 获得原图尺寸
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script> 
<!-- MathJax -->

<!-- Katex -->

<!-- busuanzi  -->
 
<script src="/js/busuanzi-2.3.pure.min.js"></script>
 
<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->
 
<link rel="stylesheet" href="/css/clipboard.css">
 <script src="https://cdn.staticfile.org/clipboard.js/2.0.10/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // 等待两秒钟后恢复
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>
 
<!-- CanvasBackground -->

<script>
  if (window.mermaid) {
    mermaid.initialize({ theme: "forest" });
  }
</script>


    
    

  </div>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        tex2jax: {
            inlineMath: [ ["$","$"], ["\\(","\\)"] ],
            skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
            processEscapes: true
        }
    });
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax();
        for (var i = 0; i < all.length; ++i)
            all[i].SourceElement().parentNode.className += ' has-jax';
    });
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-MML-AM_CHTML"></script>

</body>

</html>